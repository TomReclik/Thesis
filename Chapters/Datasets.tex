\chapter{Datasets}


\section{Introduction}

The collection of a dataset is a crucial step in the construction of a machine learning based classification algorithm. Since a neural network learns from labeled samples, any bias from a researcher involved in the annotation of the data will be transfered to the network. It is therefore necessary to create clear class definitions, suppressing any possible bias through the interpretation involved in the labeling. \\


%The collection of a dataset is a crucial step in the construction of a machine learning based classification algorithm. Since a neural network learns given the examples shown to it, any bias from a researcher involved in the labeling of the data will be learned by the network. It is therefore necessary to find class definitions clear enough for different researchers to arrive at the same conclusion for different similar sites. This is due to two reasons. Firstly when multiple people are involved in the creation of a labeled dataset conflicting interpretations of the given classes will lead the neural network to perform poorly since similar sites might be labeled differently. \\


\section{Data Collection - First Stage}
In the first stage of data collection, damage sites in SEM micrographs were classified using the conventional class definitions for damage sites in dual-phase steels. These consist of martensite cracking, interface decohesion, boundary decohesion and inclusions, as explained in chapter \ref{cha:cha:DualPhaseSteels}. Additionally he class of evolved damage sites was introduced. These sites are damage sites in a later stage of their evolution, where it is not possible to clearly establish what mechanism lead to the formation of the void in the microstructure. \\



Due to the time intensity involved in the evaluation of SEM micrographs, two researchers were involved in the labeling of damage sites, using the labeling tool labelImg \cite{labelImg}. This tool enables its user to zoom into images, find objects of interest, create a rectangle around the object and annotate it. Additionally it is possible to mark objects as difficult, which was used when damage sites could not be clearly identified by one researcher and further discussion was necessary. If both researchers would not arrive at the same conclusion the "difficult" mark would remain, leaving the option to exclude these sites from training, as these sites are not representative of a specific damage mechanism. A labeled micrograph using labelImg can be seen in figure \ref{fig:labelImg}. 

\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{labelImg.png}
\caption{Damage site classification using labelImg.}
\label{fig:labelImg}
\end{figure}

%In order to have a consistently labeled dataset, the researcher further more would correspond if instances appeared that were difficult to assign a class. If a consensus was reached the class agreed upon was chosen as the class for this particular instance, otherwise the "difficult" label was added. During labeling difficulties arose for the assignment of boundary decohesions and evolved damage sites. Therefore an internal study was performed assessing whether the class definitions were clear enough. 

\section{Consistency of Class Definitions}

In order to test whether different researchers given the class definitions, given in chapter \ref{cha:DualPhaseSteels}, would arrive at the same conclusion, indicating that no bias during the creation of a dataset was transfered, an internal study was performed. In this study five experts, researching in the field of material science, were asked to label $25$ different images given the following class definitions.\\

\begin{itemize}[label={}]
\item \textbf{Inclusion}: "Inclusions, either holes left from preparation or actual inclusions."
\item \textbf{Martensite Cracking}: "Brittle cracked martensite islands."
\item \textbf{Interface Decohesion}: "Damage to the martensite/ferrite boundary."
\item \textbf{Boundary Decohesion}: "Damage to ferrite grain boundaries."
\item \textbf{Evolved Damage}: "More than one active damage mechanism, e.g. martensite cracking evolved into ductile damage in ferrite."
\end{itemize}

The resulting consensus on all classes can be seen in the following sections. 

\subsection{Martensite Cracking}

\begin{figure}[H]
\begin{subfigure}{.25\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Martensite0.pdf}
  \caption{}
  \label{fig:MC1}
\end{subfigure}%
\begin{subfigure}{.25\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Martensite1.pdf}
  \caption{}
  \label{fig:MC2}
\end{subfigure}%
\centering
\begin{subfigure}{.25\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Martensite2.pdf}
  \caption{}
  \label{fig:MC3}
\end{subfigure}%
\begin{subfigure}{.25\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Martensite3.pdf}
  \caption{}
  \label{fig:MC4}
\end{subfigure}%
\caption{Classes preclassified as martensite cracking. The assigned classes in the study are shown below the damage site.}
\label{fig:classes}
\end{figure}

For damage sites shown in figures \ref{fig:MC1} and \ref{fig:MC2} all researchers concluded that these sites result from martensite cracking. For the damage site shown in \ref{fig:MC3} one researcher concluded that this site resulted from interface decohesion. Upon closer inspection one can see that some ferrite remains between the two martensite islands and that they do not have a matching shape, therefore the underlying mechanism is interface decohesion. The last damage site shown in figure \ref{fig:MC4} lead to larger disagreement. Due to the wider shape of the damage site and the fact that it grew into the surrounding ferrite one of the researchers classified this site as an evolved damage site, while another categorized it as interface decohesion, similarly to damage site \ref{fig:MC3}. 

\subsection{Inclusion}

\begin{figure}[H]
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Inclusion_0.pdf}
  \caption{}
  \label{fig:Inc1}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Inclusion_1.pdf}
  \caption{}
  \label{fig:Inc2}
\end{subfigure}%
\centering
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Inclusion_2.pdf}
  \caption{}
  \label{fig:Inc3}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Inclusion_3.pdf}
  \caption{}
  \label{fig:Inc4}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Inclusion_4.pdf}
  \caption{}
  \label{fig:Inc5}
\end{subfigure}%
\caption{Damage sites classified beforehand as inclusions. Shown underneath are the classes arrived at in the study.}
\label{fig:classes}
\end{figure}

For inclusion sites the majority of researchers arrive at the predetermined class conclusion. The site shown in figure \ref{fig:Inc3} was classified as interface decohesion by one researcher, even though the foreign particle is still remaining in the micrograph, this is a case of a clearly misclassified damage site. For both damage sites shown in figures \ref{fig:Inc4} and \ref{fig:Inc5} disagreement exists whether these sites are evolved damage sites or inclusions. Additionally the damage site shown in figure \ref{fig:Inc5} was not classifiable for one researcher.



\subsection{Evolved}

\begin{figure}[H]
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Evolved_0.pdf}
  \caption{}
  \label{fig:Ev1}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Evolved_1.pdf}
  \caption{}
  \label{fig:Ev2}
\end{subfigure}%
\centering
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Evolved_2.pdf}
  \caption{}
  \label{fig:Ev3}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Evolved_3.pdf}
  \caption{}
  \label{fig:Ev4}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Evolved_4.pdf}
  \caption{}
  \label{fig:Ev5}
\end{subfigure}%
\caption{}
\label{fig:classes}
\end{figure}



For evolved damage sites only for the site shown in figure \ref{fig:Ev1} the majority of researchers arrived at the same conclusion. For all other damage sites different underlying damage mechanism were found.

\subsection{Boundary Decohesion}

\begin{figure}[H]
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Boundary0.pdf}
  \caption{}
  \label{fig:BD1}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Boundary1.pdf}
  \caption{}
  \label{fig:BD2}
\end{subfigure}%
\centering
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Boundary3.pdf}
  \caption{}
  \label{fig:BD3}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Boundary2.pdf}
  \caption{}
  \label{fig:BD4}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Boundary4.pdf}
  \caption{}
  \label{fig:BD5}
\end{subfigure}%
\caption{}
\label{fig:BD}
\end{figure}

While for the damage sites shown in figures \ref{fig:BD1}, \ref{fig:BD2}, and \ref{fig:BD3} the majority of researchers arrived at the conclusion that these sites show boundary decohesions, the confusion among the researchers is similarly large to the case of evolved damage sites. This indicates that this class is either ill defined or that the sites shown are not representative of boundary decohesions. As can be seen in the boundary decohesion sites shown in figure \ref{fig:BD}, and can be seen in all boundary decohesion sites found in the material, all voids are cornered by martensite grains. This supports the idea explained in \ref{sec:DamageSites} that the void did not nucleate directly at the boundary between two ferrite grains, but instead other mechanisms were involved, resulting in damage sites that either stem from a void nucleating at the point were a ferrite ferrite grain boundary meets a martensite grain, or another mechanism lead to a damage site resembling a boundary decohesion site. 


\subsection{Interface Decohesion}


\begin{figure}[H]
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Interface_0.pdf}
  \caption{}
  \label{fig:ID1}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Interface_1.pdf}
  \caption{}
  \label{fig:ID2}
\end{subfigure}%
\centering
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Interface_2.pdf}
  \caption{}
  \label{fig:ID3}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Interface_3.pdf}
  \caption{}
  \label{fig:ID4}
\end{subfigure}%
\begin{subfigure}{.2\textwidth}
\centering
  \includegraphics[width=.8\linewidth]{/Classification/Interface_4.pdf}
  \caption{}
  \label{fig:ID5}
\end{subfigure}%
\caption{}
\label{fig:classes}
\end{figure}

For small damage sites predetermined to be interface decohesions, agreement between researchers was reached, \ref{fig:ID1} \ref{fig:ID2}, \ref{fig:ID3}. Due to the round nature and bright martensite in figure \ref{fig:ID4} this site has probably been classified as an inclusion. The last damage site \ref{fig:ID5} shows interface decohesion that has grown into the ferrite and has therefore been classified by the majority of researchers as an evolved damage site. 

\subsection{Conclusion}
Due to the problems arising in the study the class definitions were refined. The class of boundary decohesions was not used in further classifications, instead a new class, the notch effect was added. This class is defined by a stress concentration in the microstructure. After nucleation of a void these damage sites show as a void between two martensite islands, that may have been a single martensite island or two martensite islands with a ferrite bridge in between them. These sites then later can evolve into sites resembling boundary decohesions. A diagrammatic depiction of such a site can be seen in figure \ref{fig:Notch_scalebar}. \\

\begin{figure}[H]
\centering
\includegraphics[scale=1]{NotchEffect_abstraction_scalebar.pdf}
\caption{A diagrammatic depiction of a notch effect damage site.}
\label{fig:Notch_scalebar}
\end{figure}

Due to the problems in finding an agreement between the different researchers for the classification of a site as evolved, this class was omitted from training but was still included in the labeling process. One problem in the classification of a damage site as "evolved" is the difficulty in defining a clear threshold, which a damage site has to exceed in order to be categorized as evolved. Furthermore, multiple damage mechanisms play a role in the formation of an evolved damage site. As the network learns to distinguish between different mechanisms, including a class that consists to varying degrees of these mechanisms, this would lead to a slowed down learning process at best, resulting in the need for a much larger dataset, and in the worst case to a network not converging to a satisfactory minimum, resulting in a useless classifier.\\ 

Due to the problems arising in arriving at an agreement for a damage site belonging to the class "evolved damage" this class was emitted from training. On the one hand due to the lack of a clear threshold after which a damage sites is "evolved" and secondly this class is a collection of different mechanisms and damage sites can look very differently. This would prove difficult for a neural network to learn the relevant features, classifying a damage site as evolved. \\

The definitions for the remaining classes, martensite cracking, interface decohesion, and inclusion, stay unchanged. 
%Investigating the agreement with the predetermined classes for each sample is shown in table \ref{tab:Reliability}. As can be seen similar difficulties were found for the classes boundary decohesion and evolved damages. Furthermore it was found that due to the high martensite concentration, ferrite grains rarely if at all were directly adjacent to each other. Rather ferrite grains were seperated by martensite grains. Indicating that damage sites marked as boundary decohesions result from different mechanisms. \\

%Additionally it was found that damage sites appeared often between the tips of two martensite islands. Therefore a new class was introduced, termed notch effect. This category is classified by its location in the microstructure exhibiting a special geometry. Due to the hardness of the martensite at this point in the geometry a stress concentration is present, resulting the formation of a damage site. In contrast to the other classes the underlying physical process, leading to the formation of a void, is not determined. It is possible that the two martensite islands were connected, prior to the crack occuring, or that a ferrite bridge existed between two separate martensite islands and an interface decohesion took place. \\

%Collecting the answers of all researchers and calculating their agreement with the predetermined classes results in the following accuracies.
%
%\begin{table}[H]
% \begin{center}
%  \begin{tabular}{@{} *2l @{}} \toprule[2pt]
%   Damage Category & Accuracy \\\midrule
%   Martensite Cracking & $85 \%$   \\ 
%   Inclusion  & $84 \%$ \\ 
%   Interface Decohesion  & $76 \% $ \\
%   Evolved & $56\%$ \\
%   Boundary Decohesion & $44 \%$ \\ \bottomrule[2pt]
%
%  \end{tabular}
% \end{center}
% \caption{Agreement for the classification of damage sites by hand. }
% \label{tab:Reliability}
%\end{table}


%
%During labeling, some difficulties arose. Mainly the classes boundary decohesion and evolved damage site posed particularly difficult. An internal study was therefore performed in order to assert whether the class definitions were narrow enough. The study showed that other researchers also had difficulties in classifying damage sites predetermined to belong to these classes. 
%The agreement with the damage classes determined beforehand can be seen in table \ref{tab:Reliability}. Major problems arose with boundary decohesions and evolved damage sites. Due to the high concentration of martensite in the dual-phase steel used, few ferrite grains are adjacent to each other. Therefore boundary decohesions will occur rarely, and sites resembling boundary decohesions probably result from other mechanisms. Problems with evolved damage sites come from the lack of a clear threshold after which a damage site falls into this class. Due to this, boundary decohesions and evolved damages were not used for the classification algorithm to distinguish between.\\
%
%\begin{table}[H]
% \begin{center}
%  \begin{tabular}{@{} *2l @{}} \toprule[2pt]
%   Damage Category & Accuracy \\\midrule
%   Martensite Cracking & $85 \%$   \\ 
%   Inclusion  & $84 \%$ \\ 
%   Interface Decohesion  & $76 \% $ \\
%   Evolved & $56\%$ \\
%   Boundary Decohesion & $44 \%$ \\ \bottomrule[2pt]
%
%  \end{tabular}
% \end{center}
% \caption{Agreement for the classification of damage sites by hand. }
% \label{tab:Reliability}
%\end{table}

\section{Data Collection - Second Stage}

Since the information of the location of the damage site inside of the micrograph is not necessary for the training of a classifier, a new method was used for the classification of damage sites. The goal is to eliminate the need to search for damage sites by hand, therefore reducing the overall required time associated with the collection of data.\\

This was achieved by using DBSCAN, as explained in \ref{sec:DBSCAN}, in order to localize damage sites. Then use the information about the location for the extraction of a site of interest. And finally assigning each damage site a unique number, such that all the work that has to be done be hand is restricted to assigning a class definition to the damage site. This process is illustrated in figure \ref{fig:LabelingSecondStage}.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{/Datasets/DataCollectionSecondStage.pdf}
\caption{The extraction of damage sites for a shorter annotation time.}
\label{fig:LabelingSecondStage}
\end{figure}

\section{Shadows}

As the detector of the SEM is not located on the same axis as the electron source, the topography of the surface can show shadows. Because damage sites are located using a binarization of the micrograph depending on their gray-values, these shadows will be found as candidates for damage sites, to be classified by a CNN. This would introduce a systematic error to the evaluation of damage sites, as the classifier is not trained to distinguish between a shadow and an actual damage site, and therefore sites not belonging to any class can be possible classified as one. The predictions of a classifier receiving a shadow as its input will be evaluated in \ref{sec:Robustness}.


\begin{figure}[H]
\begin{subfigure}{.24\textwidth}
\includegraphics[width = 0.9\linewidth]{/Shadows/Nothing_191.png}
\end{subfigure}
\begin{subfigure}{.24\textwidth}
\includegraphics[width = 0.9\linewidth]{/Shadows/Nothing_223.png}
\end{subfigure}
\begin{subfigure}{.24\textwidth}
\includegraphics[width = 0.9\linewidth]{/Shadows/Nothing_115.png}
\end{subfigure}
\begin{subfigure}{.24\textwidth}
\includegraphics[width = 0.9\linewidth]{/Shadows/Nothing_132.png}
\end{subfigure}
\caption{Shadows found in the surface micrographs.}
\end{figure}

\section{Size of the Dataset}

The data collected is shown in table \ref{tab:Dataset}. Overall $4294$ samples were gathered distributed unevenly among the four classes. In modern CNN applications, the dataset used is usually orders of magnitude larger. This poses a challenge for the classification algorithm, as the dataset might be to small for a CNN to learn relevant features from. In order to prevent the network from having to adjust for different experimental settings, therefore preventing the 

\begin{table}[H]
\begin{center}
\begin{tabular}{@{} *5l @{}} \toprule[2pt]
Training set &  \multicolumn{4}{c}{Damage Mechanism}   \\\midrule
 & Inc & MC & ID & NE   \\ 
ex-situ  & 379 & 691 & 788 & 443\\ 
in-situ  & 193 & 796 & 586 & 418 \\ \bottomrule
all  & 572 & 1487 & 1374 & 861\\\bottomrule[2pt]

\end{tabular}
\end{center}
\end{table}



\section{Class Imbalance}

As can be seen in figure \ref{fig:datasets}, the number of samples per class are distributed unevenly, a so called class imbalance. The action of a neural network can be understood to some degree as an approximation of the Bayesian a posteriori probability. If the frequency of the distribution among classes varies heavily, this will introduce an a priori probability into the a posteriori probability. It is now possible for a neural network to maximize its precision, the a priori probability will be learned, and classes with few examples will not be learned by the network and therefore not predicted. E.g. In the extreme case of two classes, where class $1$ occurs $99$ more often than class $2$, always predicting class $1$ will lead to a high accuracy on the training dataset. \\

\begin{figure}[H]
\centering
\includegraphics[width=\textwidth]{/Datasets/Dataset.pdf}
\caption{Distribution of samples among the classes inclusion (Inc), notch effect (NE), interface decohesion (ID), and martensite cracking (MC), in increasing order.}
\label{fig:datasets}
\end{figure}

Multiple methods exist addressing this issue. They can be categorized in sampling methods, artificially modifying the sample distribution in the training dataset, and methods modifying the learning process and prediction of a classifier. In the following a selection of possible methods will be explained

\subsection{Oversampling}
Oversampling describes the usage of already available examples of underrepresented classes multiple times. The most basic approach is to randomly select elements of an underrepresented class and add it to the training set until the classes are balanced. Because the information coded in the samples of the underrepresented classes is used multiple times, this method comes with the danger of overfitting and poor generalizability. Furthermore due to increased training size, the time a network requires for training is increased. 

\subsection{Undersampling}
Undersampling follows the opposite idea of oversampling. Instead of increasing the training dataset with samples from the underrepresented class, samples from overrepresented classes are chosen at random until all classes have the same amount of training data. The obvious downside to this method is that not all available data is used for training. While balance is restored the possible accuracy for overrepresented classes may not be achieved. As the training size decreases, the required time for training also decreases. \\

\subsection{Scaling}
Scaling is a method modifying the learning process of a neural network. The adjustment of the weights due to a sample belonging to a class with lower frequency will be increased by a factor, depending on the a priori probability of that class. Correspondingly this can be understood as the modification of the error function, with the corresponding scaling factor. Wrong classifications of underrepresented classes therefore lead to a larger overall error. 

\subsection{Post-Scaling}
Instead of modifying the learning process, this method aims to correct the prediction of a neural network after it has been trained. The output of the network is then scaled with the a priori probability. Both scaling and post-scaling methods heavily rely on the Bayesian a posteriori probability interpretability of the output of the network.\\

\subsection{Conclusion}
Buda et. al. performed experiments on three benchmark datasets, in order to investigate the influence of class imbalance and the performance of methods used to compensate its effects \cite{Buda2017}. The two major points found in this work that are relevant for this thesis are 
\begin{itemize}
\item The most dominant method is oversampling
\item Oversampling does not imply overfitting
\end{itemize}
In the following oversampling will therefore be the method of choice when dealing with imbalanced class distributions.





%Due to the necessary time for the labeling of damage sites, this task is performed by multiple researchers. Unclear class definitions will lead to different conclusions for similar damage sites, leading the neural network to adapt its weights once in order to learn the mapping $o_0 \mapsto c_0$ and for a similar object $o_1 \mapsto c_1$, while the true class may be either $c_0$ or $c_1$. This will nullify the correction of the networks weights. \\

%\section{Reliability of Training Data}
%
%Due to the need of consistently labeled datasets, for the training process of the classifier, a study was performed internally beforehand. Five experts were asked to classify $25$ damage sites given the following descriptions. 
%\begin{itemize}[label={}]
%\item \textbf{Inclusion}: Inclusions, either holes left from preparation or actual inclusions.
%\item \textbf{Martensite Cracking}: Brittle cracked martensite islands.
%\item \textbf{Interface Decohesion}: Damage to the martensite/ferrite boundary.
%\item \textbf{Boundary Decohesion}: Damage to ferrite grain boundaries.
%\item \textbf{Evolved Damage}: More than one active damage mechanism, e.g. martensite cracking evolved into ductile damage in ferrite.
%\end{itemize}
%The agreement with the damage classes determined beforehand can be seen in table \ref{tab:Reliability}. Major problems arose with boundary decohesions and evolved damage sites. Due to the high concentration of martensite in the dual-phase steel used, few ferrite grains are adjacent to each other. Therefore boundary decohesions will occur rarely, and sites resembling boundary decohesions probably result from other mechanisms. Problems with evolved damage sites come from the lack of a clear threshold after which a damage site falls into this class. Due to this, boundary decohesions and evolved damages were not used for the classification algorithm to distinguish between.\\
%
%\begin{table}[H]
% \begin{center}
%  \begin{tabular}{@{} *2l @{}} \toprule[2pt]
%   Damage Category & Accuracy \\\midrule
%   Martensite Cracking & $85 \%$   \\ 
%   Inclusion  & $84 \%$ \\ 
%   Interface Decohesion  & $76 \% $ \\
%   Evolved & $56\%$ \\
%   Boundary Decohesion & $44 \%$ \\ \bottomrule[2pt]
%
%  \end{tabular}
% \end{center}
% \caption{Agreement for the classification of damage sites by hand. }
% \label{tab:Reliability}
%\end{table}
%
%Furthermore damage sites located in a special geometrical constellation appeared often. These are classified by being located between the tips of two martensite islands. The underlying mechanisms of the nucleation of these damage sites is unknown, and might result from the cracking of one formerly connected martensite or the decohesion of a ferrite bridge between two martensite islands. Characteristic for this constellation is a stress concentration at this particular point in the microstructure, this class is called notch effect. The final classes used for classification in this work are shown in figure \ref{fig:classes}.
%
%\begin{figure}[H]
%\begin{subfigure}{.25\textwidth}
%\centering
%  \includegraphics[width=.8\linewidth]{MartensiteCracking_abstraction_scalebar.pdf}
%  \caption{MC}
%  \label{fig:MC}
%\end{subfigure}%
%\begin{subfigure}{.25\textwidth}
%\centering
%  \includegraphics[width=.8\linewidth]{InterfaceDecohesion_abstraction_scalebar.pdf}
%  \caption{ID}
%  \label{fig:Interface_scalebar}
%\end{subfigure}%
%\centering
%\begin{subfigure}{.25\textwidth}
%\centering
%  \includegraphics[width=.8\linewidth]{NotchEffect_abstraction_scalebar.pdf}
%  \caption{NE}
%  \label{fig:Notch_scalebar}
%\end{subfigure}%
%\begin{subfigure}{.25\textwidth}
%\centering
%  \includegraphics[width=.8\linewidth]{Inclusion_abstraction_scalebar.pdf}
%  \caption{Inclusion}
%  \label{fig:Inclusion_scalebar}
%\end{subfigure}%
%\caption{Abstracted damage mechanism for martensite cracking (MC) in subfigure (a), interface decohesion (ID) in subfigure (b), notch effect (NE) in subfigure (c),  and inclusions in subfigure (d). The martensite islands, the ferrite matrix, and the foreign body are labeled as M, F, and I respectively.}
%\label{fig:classes}
%\end{figure}
%
%
%
%\section{Influence of an Incorrectly Labeled Dataset}
%
%The influence of an incorrectly labeled dataset was studied using the CIFAR-10 dataset, with the EERACN network, see \ref{app:EERACN}. The network was trained for $30$ epochs with an Adam optimizer \cite{Sharma2017} with a learning rate of $0.0005$ and other parameters set to default. The baseline accuracy for a correctly labeled dataset with constant seeds among experiments and fluctuations resulting from the use of GPU is $0.73\pm 0.01$. Purposely mislabeling $30 \%$, corresponding to the average mislabeling rate from \ref{tab:Reliability}, of the training data leads to an accuracy of $0.66\pm 0.01$ evaluated on a dataset with correct labels, leading to a drop in the accuracy of $0.07 \pm 0.01$. For a realistic setting the test dataset will also be mislabeled. Evaluating the trained network on a mislabeled dataset leads to a further drop in the accuracy to $0.43\pm 0.01$, since correctly labeled inputs will be evaluated as wrong predictions. The mislabeled data has therefore two effects. Firstly the performance of the network drops significantly. Secondly the measured accuracy of the network will be skewed towards a network using random predictions. 
%
%
%%The network was once trained with a correctly labeled dataset and then with a dataset with $30\%$ of the datapoints mislabeled, corresponding to the average mislabeling rate from \ref{tab:Reliability}. The baseline accuracy for a correctly labeled dataset with constant seeds among experiments and fluctuations resulting from the use of GPU is $0.73\pm 0.01$. Training the network with mislabeled data and evaluating the trained network on a dataset labeled correctly the accuracy drops to $0.66\pm 0.01$. Because the data used for the training of a network distinguishing between damage mechanisms is completely labeled by hand the test dataset would also be labeled incorrectly. The accuracy of a network evaluated on a test dataset with inconstistent labeling leads to a further drop in the accuracy to $0.43\pm 0.01$, due to correct predictions being labeled as wrong.\\
%
%
%\section{Datasets}
%The datasets were obtained from SEM micrographs by two researchers. 
%
%
%
%The datasets were obtained in two ways. At first labelImg \cite{labelImg} was used. With this tool it is possible to mark damage sites in SEM panoramas, requiring the user to search for them by zooming into the micrograph. Later once the localization algorithm was implemented as explained in chapter \ref{cha:Localization}, significantly reducing the required time for the creation of a dataset by negating the need to localize damage sites by hand. \\
%
%\begin{figure}[H]
%\begin{subfigure}{.5\textwidth}
%\centering
%  \includegraphics[width=.8\linewidth]{Artifact_scalebar.png}
%\end{subfigure}
%\begin{subfigure}{.5\textwidth}
%\centering
%  \includegraphics[width=.8\linewidth]{Artifact_2_scalebar.png}
%\end{subfigure}
%\caption{Artifact showing on the surface of the sample.}
%\label{fig:artifacts}
%\end{figure}
%
%During deformation artifacts can form on the surface of the micrograph. A few examples of such artifacts are shown in figure \ref{fig:artifacts}. Due to the preparation of the sample these do not show in ex-situ experiments and very rarely in early stages of in-situ experiments. The dataset is therefore split into two categories. The first one consists of surface micrographs not containing artifacts on the sample's surface, while the second one consists of surface micrographs containing said artifacts. \\
%
%The available data for each damage mechanism and category after labeling is shown in table \ref{tab:Dataset}.
%
%%The data is split into two categories. The first category are surface micrographs that were taken right after preparing the sample. Due to the preparation these do not contain artifacts from the deformation of the sample. This first category consists of ex-situ experiments and the first stage of in-situ experiments. Later stages of in-situ experiments fall into the second category, 
%%The data is split into three parts. Firstly data from ex-situ experiments, with different grades of stress. The dual-phase steel was prepared before each recording with the SEM, therefore no artifacts can be seen on the surface of the sheet. Secondly data from the first stage of in-situ experiments, this data is  The second round of experiments was performed in-situ. Due to the in-situ nature of those experiments at higher rates of deformation, recordings contain artifacts on the surface of the probe. The datasets with the number of damage sites in each category can be seen in table \ref{tab:Dataset}. \\ 
%
%\begin{table}[H]
%\begin{center}
%\begin{tabular}{@{} *5l @{}} \toprule[2pt]
%Training set &  \multicolumn{4}{c}{Damage Mechanism}   \\\midrule
% & Inc & MC & ID & NE   \\ 
%ex-situ  & 379 & 691 & 788 & 443\\ 
%in-situ  & 193 & 796 & 586 & 418 \\ \bottomrule
%all  & 572 & 1487 & 1374 & 861\\\bottomrule[2pt]
%
%\end{tabular}
% \caption{The number of damage sites found in the ex-situ and in-situ experiments per class (inclusion (Inc), martensite cracking (MC), interface decohesion (ID), and notch effect (NE)).}
% \label{tab:Dataset}
%\end{center}
%\end{table}